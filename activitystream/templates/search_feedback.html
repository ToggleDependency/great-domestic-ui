{% extends 'core/base.html' %}

{% load static from staticfiles %}
{% load humanize %}
{% load message_box_with_icon from directory_components %}

{% block head_css %}
{{ block.super }}
<link href="{% static 'styles/default.css' %}" rel="stylesheet" type="text/css" />
<link href="{% static 'styles/pages/search-results.css' %}" rel="stylesheet" type="text/css" />
{% endblock %}

{% block head_js_ga360 %}
  {{ block.super }}
  <script src="{% static 'js/dit.tagging.js' %}"></script>
  <script id="ga360-script">
    window.dataLayer.push({ 'pageCategory': 'SearchFeedbackPage' });
    dit.tagging.domestic.init('SearchFeedbackPage');
  </script>
{% endblock %}

{% block head_title %}Feedback Form - great.gov.uk{% endblock %}

{% block content %}

<section id="search-results-information">
  <div class="container">
    {% block breadcrumbs %}
      {% include '_breadcrumbs.html' with breadcrumbs=breadcrumbs %}
    {% endblock %}
    <h1 class="heading-xlarge">Tell us how you found the new search feature</h1>
    {% if submitted %}
      {% message_box_with_icon icon="âœ“" heading="Your feedback has been sent" %}      
      <a href="{% url 'search' %}?page={{ page }}&q={{ query }}" class="font-xsmall">Return to your search</a>
    {% endif %}

  </div>
</section>

<div class="container">
  <br>
  <form action="{% url 'search-feedback' %}" method="POST">
  {% csrf_token %}
  {{ form.non_field_errors }}
  <div class="fieldWrapper">
    {{ form.result_found.errors }}
    {{ form.result_found.label_tag }}
    {{ form.result_found }}
  </div>
  <div class="fieldWrapper">
    {{ form.search_target.errors }}
    {{ form.search_target.label_tag }}
    {{ form.search_target }}
  </div>
  <div class="fieldWrapper">
    {{ form.reason_for_site_visit.errors }}
    {{ form.reason_for_site_visit.label_tag }}
    {{ form.reason_for_site_visit }}
  </div>
  {{ form.from_search_query.as_hidden }}
  {{ form.from_search_page.as_hidden }}
  <div class="fieldWrapper">
    <label class=" form-label" for="id_contactable_0">May we contact you with follow-up questions and support?</label>
    <div class="form-group">
      <ul id="id_contactable">
        <li class="multiple-choice">
          <input type="radio" name="contactable" value="yes" required="" id="id_contactable_0" onclick="toggle_contact_details('yes')">
          <label id="id_contactable_0-label" for="id_contactable_0" class="form-label">
            Yes
          </label>
        </li>
        <li class="multiple-choice">
          <input type="radio" name="contactable" value="no" required="" id="id_contactable_1" onclick="toggle_contact_details('no')">
          <label id="id_contactable_1-label" for="id_contactable_1" class="form-label">
            No
          </label>
        </li>
      </ul>
    </div>
  </div>
  <div id="contact-details">
    <div class="fieldWrapper">
      {{ form.contact_name.errors }}
      {{ form.contact_name.label_tag }}
      {{ form.contact_name }}
    </div>
    <br>
    <div class="fieldWrapper">
      {{ form.contact_email.errors }}
      {{ form.contact_email.label_tag }}
      {{ form.contact_email }}
    </div>
    <br>
    <div class="fieldWrapper">
      {{ form.contact_number.errors }}
      {{ form.contact_number.label_tag }}
      {{ form.contact_number }}
    </div>
    <br>
  </div>
  <input class="button button-blue" type="submit" value="Submit">
  </form>
</div>

<script>
  // If JS is enabled, initially hide the contact details box
  contactDetails = document.getElementById("contact-details")
  contactDetails.style.display = 'none'

  function toggle_contact_details(input){
    if(input == 'yes'){
      contactDetails.style.display = 'block'
    } else {
      contactDetails.style.display = 'none'
    }
  }
</script>

{% endblock %}
